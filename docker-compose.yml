# ===========================================
# TebroShelf - Base Docker Compose Configuration
# ===========================================
# Usage:
#   Dev:  docker compose -f docker-compose.yml -f docker-compose.dev.yml --env-file .env.dev up
#   Prod: docker compose -f docker-compose.yml -f docker-compose.prod.yml --env-file .env.prod up -d
# ===========================================

services:
  client:
    build:
      context: ./client
    depends_on:
      server:
        condition: service_healthy
    networks:
      - tebroshelf-network

  server:
    build:
      context: ./server
    environment:
      - NODE_ENV=${NODE_ENV}
      - PORT=${PORT:-3000}
      - DATABASE_PATH=${DATABASE_PATH}
      - SESSION_EXPIRY_DAYS=${SESSION_EXPIRY_DAYS:-7}
      - SESSION_CLEANUP_INTERVAL_MS=${SESSION_CLEANUP_INTERVAL_MS:-3600000}
      - SLIDING_EXPIRATION=${SLIDING_EXPIRATION:-false}
      - WATCH_DIR=${WATCH_DIR:-/app/data/watch}
      - USE_POLLING=${USE_POLLING:-false}
    networks:
      - tebroshelf-network

networks:
  tebroshelf-network:
    driver: bridge
